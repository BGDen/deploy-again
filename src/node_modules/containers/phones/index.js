import React from 'react'
import { connect } from 'react-redux'
import * as R from 'ramda'
import { Link } from 'react-router-dom'

import Grid from '@material-ui/core/Grid'
import Button from '@material-ui/core/Button'
import Typography from '@material-ui/core/Typography';
import { red, green } from '@material-ui/core/colors';
import Box from '@material-ui/core/Box';
import CardContent from '@material-ui/core/CardContent';




import { 
  fetchPhones, 
  loadMorePhones, 
  addPhoneToBasket,
  fetchCategories
} from 'actions'

import { getPhones } from 'selectors'
import Layout from 'containers/layout'

class Phones extends React.Component {
  componentDidMount(){
    this.props.fetchPhones()
    this.props.fetchCategories()
  }

  renderPhone (phone, index){
    const shortDescription = `${R.take(60, phone.description)}...`
    const {addPhoneToBasket} = this.props
    return (
      <div className='col-sm-4 col-lg-4 col-md-4 book-list' key={index}>
        <div className='thumbnail'
             style={{
                    //  border: '1px solid black',
                     paddingLeft: 3,
                     paddingRight: 3,
                     marginBottom: 10
                    }}>

          <img
            className='img-thumbnail'
            src={phone.image}
            alt={phone.name}
            style={{marginBottom: 15, marginTop: 5}}
          />
          <CardContent>
            <Grid
              container
              direction="row"
              justify="space-between"
              alignItems="center"
              style={{marginBottom: 10}}
            >
              <h5>
                <Link
                  to={`/phones/${phone.id}`}
                  style={{textDecoration: 'none'}}
                >
                    {phone.name}
                </Link>
              </h5>
              <h4 className='pull-right'>${phone.price}</h4>
            </Grid>
            <Typography component="p" style={{marginBottom: 20}}>
                {shortDescription}
            </Typography>
            <Grid container direction="row" justify="space-around" alignItems="center">
              <Button
                selected
                size="small"
                variant="outlined"
                style={{color: red['A700'], borderColor: 'inherit'}}
                onClick={()=> addPhoneToBasket(phone.id)}
                // fontWeight={700}
              >
                {/* <Box fontWeight="fontWeightBold"> */}
                  Buy now!
                {/* </Box> */}
              </Button>
              <Button
                size="small"
                variant="outlined"
              >
                <Link 
                  to={`/phones/${phone.id}`}
                  style={{ color: green['A700'], textDecoration: 'none'}}
                >
                  <Box fontWeight="fontWeightBold">
                    More info
                  </Box>
                </Link>
              </Button>
            </Grid>
          </CardContent>
        </div>
      </div>
    )
  }

  render() {
    const {phones, loadMorePhones} = this.props
    return(
      <Layout>
        <div className='books row'>
          {phones.map((phone, index)=> this.renderPhone(phone, index))}
        </div>
        <div className='row'>
          <div className='col-md-12'>
            <button 
              onClick={loadMorePhones}
              className='pull-right btn btn-primary'
            >
              Load More
            </button>
          </div>
        </div>
      </Layout>
      )
  }
}

const mapStateToProps = (state, ownProps) => ({
  phones: getPhones(state, ownProps)
})

const mapDispatchToProps = {
  fetchPhones,
  loadMorePhones,
  addPhoneToBasket,
  fetchCategories
}

export default connect(mapStateToProps, mapDispatchToProps)(Phones)